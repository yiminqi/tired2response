<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>职场多轮对话Prompt生成器</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
  <div class="w-full max-w-2xl bg-white p-6 rounded-2xl shadow-lg">
    <h1 class="text-2xl font-bold mb-4 text-center">职场多轮对话Prompt生成器</h1>

    <!-- 设置角色、立场、风格、场景 -->
    <div class="mb-4 space-y-4">
      <!-- 对方身份 -->
      <div>
        <label class="block mb-1 font-medium">对方身份</label>
        <select id="roleSelect" class="w-full border rounded px-3 py-2" onchange="toggleCustom('role')">
          <option value="上级">上级</option>
          <option value="平级同事">平级同事</option>
          <option value="下属">下属</option>
          <option value="客户">客户</option>
          <option value="合作方">合作方</option>
          <option value="追求者">追求者</option>
          <option value="不熟同事">不熟同事</option>
          <option value="自定义">自定义</option>
        </select>
        <input type="text" id="roleCustom" class="w-full border rounded px-3 py-2 mt-1 hidden" placeholder="请输入自定义对方身份" />
      </div>

      <!-- 用户立场 -->
      <div>
        <label class="block mb-1 font-medium">用户立场</label>
        <select id="stanceSelect" class="w-full border rounded px-3 py-2" onchange="toggleCustom('stance')">
          <option value="想维持关系">想维持关系</option>
          <option value="想保持距离">想保持距离</option>
          <option value="想明确边界">想明确边界</option>
          <option value="想保留证据">想保留证据</option>
          <option value="想拒绝">想拒绝</option>
          <option value="想拖延">想拖延</option>
          <option value="自定义">自定义</option>
        </select>
        <input type="text" id="stanceCustom" class="w-full border rounded px-3 py-2 mt-1 hidden" placeholder="请输入自定义用户立场" />
      </div>

      <!-- 回复风格 -->
      <div>
        <label class="block mb-1 font-medium">回复风格</label>
        <select id="styleSelect" class="w-full border rounded px-3 py-2" onchange="toggleCustom('style')">
          <option value="委婉">委婉</option>
          <option value="冷静">冷静</option>
          <option value="严肃">严肃</option>
          <option value="幽默">幽默</option>
          <option value="高情商">高情商</option>
          <option value="自定义">自定义</option>
        </select>
        <input type="text" id="styleCustom" class="w-full border rounded px-3 py-2 mt-1 hidden" placeholder="请输入自定义回复风格" />
      </div>

      <!-- 场景说明 -->
      <div>
        <label class="block mb-1 font-medium">场景说明</label>
        <select id="contextSelect" class="w-full border rounded px-3 py-2" onchange="toggleCustom('context')">
          <option value="工作讨论">工作讨论</option>
          <option value="生活场景">生活场景</option>
          <option value="项目沟通">项目沟通</option>
          <option value="会议汇报">会议汇报</option>
          <option value="自定义">自定义</option>
        </select>
        <input type="text" id="contextCustom" class="w-full border rounded px-3 py-2 mt-1 hidden" placeholder="请输入自定义场景说明" />
      </div>
    </div>

    <!-- 多轮对话容器 -->
    <div class="mb-4">
      <label class="block mb-1 font-medium">多轮对话</label>
      <div id="conversationContainer" class="space-y-2"></div>
      <div class="flex space-x-2 mt-2">
        <button onclick="addMessage('user')" class="flex-1 bg-blue-500 text-white py-1 rounded hover:bg-blue-600">增加用户消息</button>
        <button onclick="addMessage('other')" class="flex-1 bg-gray-500 text-white py-1 rounded hover:bg-gray-600">增加对方消息</button>
      </div>
    </div>

    <button onclick="generatePrompt()" class="w-full bg-green-600 text-white py-2 rounded hover:bg-green-700">生成Prompt</button>

    <!-- 输出Prompt -->
    <div class="mt-4">
      <label class="block mb-1 font-medium">生成的Prompt</label>
      <textarea id="output" rows="8" class="w-full border rounded px-3 py-2" readonly></textarea>
      <button onclick="copyPrompt()" class="mt-2 w-full bg-purple-600 text-white py-2 rounded hover:bg-purple-700">复制并提示使用</button>
    </div>
  </div>

  <script>
    let messageId = 0;

    // 增加消息
    function addMessage(type) {
      messageId++;
      const container = document.getElementById('conversationContainer');
      const div = document.createElement('div');
      div.className = "flex space-x-2 items-center";
      div.id = "msg_" + messageId;

      const textarea = document.createElement('textarea');
      textarea.rows = 2;
      textarea.placeholder = type === 'user' ? "用户消息" : "对方消息";
      textarea.className = "flex-1 border rounded px-2 py-1";

      const delBtn = document.createElement('button');
      delBtn.textContent = "删除";
      delBtn.className = "bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600";
      delBtn.onclick = () => container.removeChild(div);

      div.appendChild(textarea);
      div.appendChild(delBtn);
      container.appendChild(div);

      textarea.dataset.type = type;
    }

    // 下拉切换自定义输入显示
    function toggleCustom(field) {
      const select = document.getElementById(field + 'Select');
      const custom = document.getElementById(field + 'Custom');
      if(select.value === '自定义'){
        custom.classList.remove('hidden');
      } else {
        custom.classList.add('hidden');
      }
    }

    function generatePrompt() {
      // 获取值，如果选择自定义则取输入框
      const role = document.getElementById('roleSelect').value === '自定义' ? 
                   document.getElementById('roleCustom').value || '未提供' : 
                   document.getElementById('roleSelect').value;
      const stance = document.getElementById('stanceSelect').value === '自定义' ? 
                     document.getElementById('stanceCustom').value || '未提供' : 
                     document.getElementById('stanceSelect').value;
      const style = document.getElementById('styleSelect').value === '自定义' ? 
                    document.getElementById('styleCustom').value || '未提供' : 
                    document.getElementById('styleSelect').value;
      const context = document.getElementById('contextSelect').value === '自定义' ? 
                      document.getElementById('contextCustom').value || '未提供' : 
                      document.getElementById('contextSelect').value;

      const container = document.getElementById('conversationContainer');
      const messages = Array.from(container.querySelectorAll('textarea'))
        .filter(t => t.value.trim() !== '')
        .map(t => ({
          type: t.dataset.type,
          text: t.value.trim()
        }));

      if(messages.length === 0){
        alert("请至少添加一条消息！");
        return;
      }

      let convText = messages.map(m => (m.type === 'user' ? "用户：" : "对方：") + m.text).join("\n");

      const prompt = `
你是职场顾问助手。
对方身份：${role}，当前场景：${context}。
用户希望保持立场：${stance}，回复风格：${style}。
以下是多轮对话：
${convText}

请基于以上信息生成一条可发送的回复，控制在120字内，语言专业且符合指定风格。输出三种可选版本。
      `.trim();

      document.getElementById('output').value = prompt;
    }

    function copyPrompt() {
      const output = document.getElementById('output');
      output.select();
      navigator.clipboard.writeText(output.value).then(() => {
        alert("Prompt已复制到剪贴板！现在可以粘贴到豆包、千问等Chatbot里获取回复。");
      });
    }

    // 初始化默认一轮对话
    addMessage('other');
    addMessage('user');
  </script>
</body>
</html>
